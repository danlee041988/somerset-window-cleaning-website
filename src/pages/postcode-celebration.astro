---
import Layout from '~/layouts/PageLayout.astro';
import { Icon } from 'astro-icon/components';
import Image from '~/components/common/Image.astro';

const metadata = {
  title: 'Great News! We Cover Your Area | Somerset Window Cleaning',
  description: 'Fantastic! We provide professional window cleaning services in your area. Book online now for streak-free windows and exceptional service.',
  noindex: true, // Don't index celebration pages
};

// Get postcode from URL params
const url = new URL(Astro.url);
const postcode = url.searchParams.get('postcode') || '';
---

<Layout metadata={metadata}>
  <section class="relative min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 to-black overflow-hidden">
    <!-- Animated background -->
    <div class="absolute inset-0">
      <Image 
        src="~/assets/images/new-hero-image.jpg" 
        alt="Professional window cleaning service" 
        width={1600} 
        height={900} 
        style="width:100%; height:100%; object-fit:cover; opacity:0.2;" 
      />
      <div class="absolute inset-0 bg-gradient-to-t from-black via-black/70 to-transparent"></div>
    </div>

    <!-- Confetti animation -->
    <div class="absolute inset-0 pointer-events-none">
      <div class="confetti-container">
        {[...Array(50)].map((_, i) => (
          <div class="confetti" style={`animation-delay: ${Math.random() * 3}s; left: ${Math.random() * 100}%`}></div>
        ))}
      </div>
    </div>

    <!-- Content -->
    <div class="relative z-10 text-center px-4 max-w-4xl mx-auto">
      <!-- Success icon with animation -->
      <div class="mb-8 animate-bounce">
        <div class="inline-flex items-center justify-center w-24 h-24 bg-green-500 rounded-full shadow-2xl">
          <Icon name="tabler:check" class="w-16 h-16 text-white" />
        </div>
      </div>

      <!-- Main message -->
      <h1 class="text-5xl md:text-7xl font-bold text-white mb-6 animate-fade-in">
        <span class="text-green-500">Great News!</span><br/>
        We Cover Your Area!
      </h1>

      {postcode && (
        <p class="text-2xl md:text-3xl text-gray-300 mb-8 animate-fade-in-delay">
          <span class="text-red-500 font-bold">{postcode}</span> is in our service area
        </p>
      )}

      <p class="text-xl text-gray-400 mb-12 animate-fade-in-delay-2">
        Join <span class="text-red-500 font-bold">4,000+ happy customers</span> across Somerset who trust us with their windows
      </p>

      <!-- CTA Buttons -->
      <div class="flex flex-col sm:flex-row gap-4 justify-center items-center animate-fade-in-delay-3">
        <a 
          href="/book-now" 
          class="inline-flex items-center gap-3 px-8 py-4 bg-red-600 hover:bg-red-700 text-white text-lg font-bold rounded-full shadow-2xl transform hover:scale-110 transition-all duration-300 animate-pulse"
        >
          <Icon name="tabler:calendar-plus" class="w-6 h-6" />
          Book Your First Clean
        </a>
        
        <a 
          href="/services" 
          class="inline-flex items-center gap-3 px-8 py-4 bg-gray-800 hover:bg-gray-700 text-white text-lg font-medium rounded-full shadow-xl border border-gray-600 transition-all duration-300"
        >
          <Icon name="tabler:list-check" class="w-6 h-6" />
          View Our Services
        </a>
      </div>

      <!-- Trust indicators -->
      <div class="mt-16 grid grid-cols-2 md:grid-cols-4 gap-6 text-center animate-fade-in-delay-4">
        <div class="bg-gray-800/50 backdrop-blur p-4 rounded-lg border border-gray-700">
          <div class="text-3xl font-bold text-red-500">4.9â˜…</div>
          <div class="text-gray-400 text-sm">Google Rating</div>
        </div>
        <div class="bg-gray-800/50 backdrop-blur p-4 rounded-lg border border-gray-700">
          <div class="text-3xl font-bold text-red-500">48hr</div>
          <div class="text-gray-400 text-sm">Guarantee</div>
        </div>
        <div class="bg-gray-800/50 backdrop-blur p-4 rounded-lg border border-gray-700">
          <div class="text-3xl font-bold text-red-500">5+</div>
          <div class="text-gray-400 text-sm">Years Experience</div>
        </div>
        <div class="bg-gray-800/50 backdrop-blur p-4 rounded-lg border border-gray-700">
          <div class="text-3xl font-bold text-red-500">100%</div>
          <div class="text-gray-400 text-sm">Insured</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Auto redirect notice -->
  <div class="fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-96 bg-gray-800 border border-gray-700 rounded-lg p-4 text-white shadow-2xl">
    <p class="text-sm">
      <Icon name="tabler:info-circle" class="inline w-4 h-4 text-blue-400 mr-2" />
      You'll be redirected to booking in <span id="countdown" class="font-bold text-red-500">30</span> seconds...
    </p>
  </div>
</Layout>

<style>
  @keyframes fade-in {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes confetti-fall {
    to { transform: translateY(100vh) rotate(360deg); }
  }

  .animate-fade-in {
    animation: fade-in 0.8s ease-out forwards;
  }

  .animate-fade-in-delay {
    animation: fade-in 0.8s ease-out 0.3s forwards;
    opacity: 0;
  }

  .animate-fade-in-delay-2 {
    animation: fade-in 0.8s ease-out 0.6s forwards;
    opacity: 0;
  }

  .animate-fade-in-delay-3 {
    animation: fade-in 0.8s ease-out 0.9s forwards;
    opacity: 0;
  }

  .animate-fade-in-delay-4 {
    animation: fade-in 0.8s ease-out 1.2s forwards;
    opacity: 0;
  }

  .confetti {
    position: absolute;
    width: 10px;
    height: 10px;
    background: linear-gradient(45deg, #ff0000, #ff6b6b);
    animation: confetti-fall 3s linear infinite;
  }

  .confetti:nth-child(even) {
    background: linear-gradient(45deg, #ffffff, #f0f0f0);
    width: 8px;
    height: 8px;
  }

  .confetti:nth-child(3n) {
    background: linear-gradient(45deg, #ffd700, #ffed4e);
    width: 12px;
    height: 12px;
  }
</style>

<script>
  // Countdown and redirect
  let seconds = 30;
  const countdownEl = document.getElementById('countdown');
  
  const interval = setInterval(() => {
    seconds--;
    if (countdownEl) {
      countdownEl.textContent = seconds.toString();
    }
    
    if (seconds <= 0) {
      clearInterval(interval);
      window.location.href = '/book-now';
    }
  }, 1000);

  // Allow user to stay on page if they interact
  document.addEventListener('click', () => {
    clearInterval(interval);
    const notice = document.querySelector('.fixed.bottom-4');
    if (notice) {
      notice.style.display = 'none';
    }
  });
</script>